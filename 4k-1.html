<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Bachelor Party 3D Card</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #020617;
      font-family: system-ui, sans-serif;
      overflow: hidden;
    }

    .card-wrapper {
      perspective: 1200px;
      position: relative;
    }

    .card {
      width: min(90vw, 420px);
      aspect-ratio: 4 / 5;
      border-radius: 22px;
      background: radial-gradient(circle at top, #111827, #020617);
      border: 1px solid rgba(250, 204, 21, 0.4);
      box-shadow: 0 25px 60px rgba(0,0,0,0.8);
      position: relative;
      overflow: hidden;
      transform-style: preserve-3d;
      transition: transform 0.3s cubic-bezier(0.25,0.8,0.25,1),
                  box-shadow 0.3s ease;
      cursor: pointer;
    }

    .card:hover { box-shadow: 0 35px 80px rgba(250,204,21,0.4); }

    .card-inner-img {
      position: absolute;
      inset: 4%;
      width: 92%;
      height: 92%;
      object-fit: cover;
      border-radius: 18px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.9);
      pointer-events: none;
      transition: transform 0.3s ease;
    }

    /* sparks */
    .spark {
      position: absolute;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      pointer-events: none;
      animation: spark-anim 0.8s ease-out forwards;
    }
    @keyframes spark-anim {
      0% { transform: scale(1) translateY(0); opacity: 1; }
      100% { transform: scale(0.2) translateY(-40px); opacity: 0; }
    }

    /* fireworks */
    .firework {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      pointer-events: none;
    }
    .particle {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      animation: explode 1s ease-out forwards;
    }
    @keyframes explode {
      0% { transform: translate(0,0) scale(1); opacity: 1; }
      100% { transform: translate(var(--x), var(--y)) scale(0.2); opacity: 0; }
    }
  </style>
</head>
<body>

  <!-- ðŸ”Š Background Music -->
  <audio id="bgMusic" src="music.mp3" autoplay loop></audio>

  <div class="card-wrapper">
    <div class="card" id="card3d">
      <img src="bachelor_card.png" class="card-inner-img" id="cardImage" />
    </div>
  </div>

<script>
  const card = document.getElementById("card3d");
  const img  = document.getElementById("cardImage");
  const bgMusic = document.getElementById("bgMusic");

  bgMusic.volume = 0.15; // ðŸ”Š Volume = 15%

  // Mobile autoplay fix
  function enableMusic() {
    bgMusic.play();
    document.removeEventListener("click", enableMusic);
  }
  document.addEventListener("click", enableMusic);

  let rotationX = 0, rotationY = 0;

  function updateTransform(x, y) {
    const maxDegree = 12;
    rotationY = x * maxDegree;
    rotationX = -y * maxDegree;
    card.style.transform = `perspective(1200px) rotateX(${rotationX}deg) rotateY(${rotationY}deg)`;
    img.style.transform   = `translateX(${rotationY*1.2}px) translateY(${rotationX*1.2}px) scale(1.05)`;
  }

  function resetTransform() {
    card.style.transform = "perspective(1200px) rotateX(0deg) rotateY(0deg)";
    img.style.transform = "translateX(0) translateY(0) scale(1)";
  }

  function handleMove(clientX, clientY) {
    const rect = card.getBoundingClientRect();
    const x = (clientX - (rect.left + rect.width/2)) / (rect.width/2);
    const y = (clientY - (rect.top  + rect.height/2)) / (rect.height/2);
    requestAnimationFrame(() => updateTransform(x,y));
    createSpark(clientX, clientY, rect);
  }

  card.addEventListener("mousemove", e => handleMove(e.clientX, e.clientY));
  card.addEventListener("mouseleave", () => requestAnimationFrame(resetTransform));
  card.addEventListener("touchmove", e => {
    const t = e.touches[0];
    handleMove(t.clientX, t.clientY);
  });
  card.addEventListener("touchend", () => requestAnimationFrame(resetTransform));

  /* Sparks */
  let sparkCount = 0;
  const MAX_SPARKS = 40;

  function createSpark(clientX, clientY, rect){
    if (sparkCount > MAX_SPARKS) return;

    const spark = document.createElement("span");
    spark.className = "spark";

    const x = clientX - rect.left;
    const y = clientY - rect.top;

    spark.style.left = x + "px";
    spark.style.top  = y + "px";

    const size = Math.random()*6 + 4;
    spark.style.width = size + "px";
    spark.style.height = size + "px";

    const colors = ["#facc15","#ef4444","#3b82f6","#22c55e"];
    spark.style.background =
      `radial-gradient(circle, ${colors[Math.floor(Math.random()*colors.length)]}, transparent)`;

    card.appendChild(spark);
    sparkCount++;

    spark.addEventListener("animationend", () => {
      spark.remove();
      sparkCount--;
    });
  }

  /* Fireworks */
  function createFirework() {
    const firework = document.createElement("div");
    firework.className = "firework";
    card.appendChild(firework);

    const particles = 14;
    const colors = ["#facc15","#ef4444","#3b82f6","#22c55e"];

    for (let i=0; i<particles; i++) {
      const p = document.createElement("span");
      p.className = "particle";

      const angle = (i/particles)*2*Math.PI;
      const dist = Math.random()*80 + 40;
      const x = Math.cos(angle)*dist;
      const y = Math.sin(angle)*dist;

      p.style.setProperty("--x", `${x}px`);
      p.style.setProperty("--y", `${y}px`);
      p.style.background = colors[Math.floor(Math.random()*colors.length)];

      firework.appendChild(p);
      p.addEventListener("animationend", ()=>p.remove());
    }

    setTimeout(() => firework.remove(), 1200);
  }

  card.addEventListener("mouseenter", createFirework);
  setInterval(createFirework, 4000);
</script>

</body>
</html>
