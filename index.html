<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bachelor Party 3D Card</title>
  <style>
    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #020617;
      overflow: hidden;
    }
    .card-wrapper {
      perspective: 600px;
      width: 100vw;
      display: flex;
      justify-content: center;
    }
    .card {
      width: 100vw;
      max-width: 450px;
      aspect-ratio: 4/5;
      border-radius: 22px;
      background: radial-gradient(circle at 50% 30%, rgba(250,204,21,0.9), #020617);
      box-shadow: 0 0 80px rgba(250,204,21,0.8), 0 30px 70px rgba(0,0,0,0.9);
      transform-style: preserve-3d;
      will-change: transform, box-shadow, background;
      touch-action: none;
      position: relative;
      overflow: hidden;
    }
    .card-inner-img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 22px;
      pointer-events: none;
      will-change: transform;
    }
    /* Fireworks */
    .firework {
      position: absolute;
      top: 10px;
      pointer-events: none;
    }
    .particle {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      animation: explode 1s ease-out forwards;
    }
    @keyframes explode {
      0% { transform: translate(0,0) scale(1); opacity: 1; }
      100% { transform: translate(var(--x), var(--y)) scale(0.2); opacity: 0; }
    }
    /* Glassy Neon Pulse Button (small, lower) */
    #playBtn {
      position: absolute;
      bottom: 12%;
      left: 50%;
      transform: translateX(-50%);
      padding: 6px 12px;
      background: rgba(255,255,255,0.1);
      color: #facc15;
      font-weight: bold;
      font-size: 12px;
      border: 2px solid #facc15;
      border-radius: 8px;
      cursor: pointer;
      backdrop-filter: blur(6px);
      box-shadow: 0 0 12px rgba(250,204,21,0.8);
      z-index: 999;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0%   { box-shadow: 0 0 8px rgba(250,204,21,0.6), 0 0 16px rgba(250,204,21,0.4); }
      50%  { box-shadow: 0 0 20px rgba(250,204,21,1), 0 0 30px rgba(250,204,21,0.8); }
      100% { box-shadow: 0 0 8px rgba(250,204,21,0.6), 0 0 16px rgba(250,204,21,0.4); }
    }
  </style>
</head>
<body>
  <!-- ðŸ”Š Background Music -->
  <audio id="bgMusic" src="music.mp3" loop></audio>

  <div class="card-wrapper">
    <div class="card" id="card3d">
      <img src="bachelor_card.png" class="card-inner-img" id="cardImage" />
      <!-- Glassy Neon Pulse Button -->
      <button id="playBtn">â–¶ Click</button>
    </div>
  </div>

<script>
  const card = document.getElementById("card3d");
  const img  = document.getElementById("cardImage");
  const bgMusic = document.getElementById("bgMusic");
  const playBtn = document.getElementById("playBtn");

  bgMusic.volume = 0.2;

  // Enable gyroscope tilt
  function enableGyro() {
    if (typeof DeviceOrientationEvent.requestPermission === 'function') {
      // iOS Safari
      DeviceOrientationEvent.requestPermission().then(response => {
        if (response === 'granted') {
          window.addEventListener("deviceorientation", e => {
            updateGyro(e.beta, e.gamma);
          });
        }
      }).catch(console.error);
    } else {
      // Android Chrome etc.
      window.addEventListener("deviceorientation", e => {
        updateGyro(e.beta, e.gamma);
      });
    }
  }

  function updateGyro(beta, gamma) {
    const maxTilt = 30;
    const rotationX = Math.max(-maxTilt, Math.min(maxTilt, beta / 3));
    const rotationY = Math.max(-maxTilt, Math.min(maxTilt, gamma / 3));

    card.style.transform = `rotateX(${rotationX}deg) rotateY(${rotationY}deg) scale(1.1)`;
    img.style.transform  = `translateX(${rotationY*1.2}px) translateY(${rotationX*1.2}px) scale(1.05)`;
    card.style.boxShadow = `${rotationY*2}px ${rotationX*2}px 70px rgba(250,204,21,0.8), 0 30px 70px rgba(0,0,0,0.9)`;

    const lightX = 50 + rotationY*2;
    const lightY = 30 + rotationX*2;
    card.style.background = `radial-gradient(circle at ${lightX}% ${lightY}%, rgba(250,204,21,0.9), #020617)`;
  }

  // Button click to start music + gyro
  playBtn.addEventListener("click", () => {
    bgMusic.play();
    playBtn.style.display = "none";
    enableGyro();
  });

  /* Fireworks */
  function createFirework(xPos) {
    const firework = document.createElement("div");
    firework.className = "firework";
    firework.style.left = xPos + "px";
    card.appendChild(firework);

    const particles = 14;
    const colors = ["#facc15","#ef4444","#3b82f6","#22c55e"];

    for (let i=0; i<particles; i++) {
      const p = document.createElement("span");
      p.className = "particle";

      const angle = (i/particles)*2*Math.PI;
      const dist = Math.random()*100 + 60;
      const x = Math.cos(angle)*dist;
      const y = Math.sin(angle)*dist;

      p.style.setProperty("--x", `${x}px`);
      p.style.setProperty("--y", `${y}px`);
      p.style.background = colors[Math.floor(Math.random()*colors.length)];

      firework.appendChild(p);
      p.addEventListener("animationend", ()=>p.remove());
    }

    setTimeout(() => firework.remove(), 1200);
  }

  function fireworkRow() {
    const rect = card.getBoundingClientRect();
    const step = rect.width / 6;
    for (let i=1; i<=6; i++) {
      createFirework(i*step);
    }
  }

  window.addEventListener("load", () => {
    fireworkRow();
    setInterval(fireworkRow, 1500);
  });
</script>
</body>
</html>